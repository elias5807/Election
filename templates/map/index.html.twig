{% extends 'base.html.twig' %}

{% block title %}Nous trouver{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <style>
        #map { height: 500px; width: 100%; border-radius: 8px; }
    </style>
{% endblock %}

{% block body %}
    {% include 'partials/_navbar.html.twig' %}
    
    <div class="container" style="margin-top: 20px;"> 
        
        {# 
           C'est ICI que la magie opère.
           On passe les données au JS via l'attribut 'data-localisations'.
           On utilise le filtre |json_encode pour transformer le tableau PHP en texte JSON.
        #}
        <div id="map" 
            style="height: 600px;"
            data-poles="{{ poles|json_encode }}"       
            data-alertes="{{ alertes|json_encode }}"
        ></div>
    </div>
    <meta http-equiv="refresh" content="60">

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <script src="{{ asset('controllers/carte.js') }}"></script>
{% endblock %}